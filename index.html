<!doctype html><html><head><meta name=generator content="Hugo 0.110.0"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Tachunn Publication | Home</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><link rel=alternate type=application/rss+xml href=https://tachunwu.github.io/index.xml title="Tachunn Publication"><meta property="og:title" content="Tachunn Publication"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://tachunwu.github.io/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tachunn Publication"><meta name=twitter:description content><script src=https://tachunwu.github.io/js/feather.min.js></script>
<link href=https://tachunwu.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://tachunwu.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css></head><body><div class=content><header><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><div class=main><a href=https://tachunwu.github.io/>Tachunn Publication</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main class=list><div class=site-description></div><section class=list-item><h1 class=title><a href=/posts/hexagonal/>&lt;Netflix çš„è»Ÿé«”è¨­è¨ˆå“²å­¸ï¼šHexagonal Archtecture></a></h1><time>Feb 23, 2023</time><br><div class=description>Index å°è¨€ å‰è¨€ Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ Chapter 2ï¼šMonolith to Microservices Chapter 3ï¼šHexagonal Architecture Core concepts Data Sources Transport Layer The dependency graph Chapter 4ï¼šSwapping data sourcesï¼ Production å¯¦éš›æƒ…æ³ éš±è— data source çš„ç´°ç¯€ Chapter 5ï¼šTesting strategy Interactors test Data sources test E2E test å¿ƒå¾—èˆ‡ç¸½çµ å°è¨€ é€™ç¯‡æ˜¯æ•´ç†ç¿»è­¯ &lt;Ready for changes with Hexagonal Architecture>ï¼Œå…¶ä¸­ Netflix å·¥ç¨‹å¸«æŠŠå®ƒå€‘å¾ Monolith è½‰æ›åˆ° Microservices ç„¶å¾Œä»‹ç´¹ Hexagonal Architecture ç¨®ç¨®ç´°ç¯€ã€‚
å»ºè­°å„ä½è®€è€…æŠŠé€™ç¯‡ç•¶æˆæ•…äº‹ï¼Œæ›´èƒ½äº†è§£ Microservices å’Œ Hexagonal Architecture èª•ç”Ÿçš„å› æœã€‚
å‰è¨€ éš¨è‘—æ¯å¹´çš„ Netflix æˆé•·ï¼Œæˆ‘å€‘å¯¦ä½œ Application çš„æ™‚å€™å¿…é ˆç¶­æŒå¾ˆé«˜çš„æ•ˆç‡ã€‚æˆ‘å€‘çš„ Engineering çµ„ç¹”å¾ç·¨åŠ‡ã€æ’­æ”¾ã€æ’ç¨‹ã€ä¾›æ‡‰å•†ç®¡ç†ã€ç²å–åŠ‡æœ¬å…§å®¹&mldr;etcï¼Œç®¡ç†è¶…å¤šçš„ Applications ã€‚&mldr;</div><a class=readmore href=/posts/hexagonal/>Read more âŸ¶</a></section><section class=list-item><h1 class=title><a href=/posts/sqlc/>&lt;How We Went All In on ï¼šsqlc/pgx for Postgres + Go></a></h1><time>Feb 19, 2023</time><br><div class=description>è¨»è¨˜ï¼šä½œè€…æœ¬äººæœ‰æ”å½±çš„èˆˆè¶£ï¼Œæˆ‘æ‹¿ä»–çš„ä¸€å¼µç›¸ç‰‡ç•¶å°é¢ XD
Index å°è¨€ å‰è¨€ Tour database/sql lib/pq pgx go-pg gorm Research Queries as strings ORMs sqlc Codegen pgx support appears Caveats and workarounds Summary and future å°è¨€ é€™ç¯‡æ–‡ç« æ˜¯å°ˆç‚º Go é–‹ç™¼è€…å¯«çš„ï¼Œä¸»è¦ç¿»è­¯ &lt;How We Went All In on sqlc/pgx for Postgres + Go>ï¼Œé€™ç¯‡æ–‡ç« çš„ä½œè€…æœ¬èº«åœ¨ Heroku å·¥ä½œéä¹Ÿåœ¨ stripe å·¥ä½œéï¼ŒåŒæ™‚ä¹Ÿæ˜¯æå‡º Idempotent Key API çš„äººã€‚
ç¾åœ¨ä»–åœ¨ Crunchy Data é–‹ç™¼ platform APIï¼Œå°æ–¼ Postgres å’Œ Go éƒ½ç®—æ˜¯éå¸¸æœ‰ç¶“é©—çš„å°ˆå®¶ï¼Œé€™ç¯‡æ–‡ç« æœƒåˆ†äº«ä¸€äº›ä»–å°ç•¶å‰ç”Ÿæ…‹ç’°å¢ƒ Go å¦‚ä½•æ“ä½œ Postgres çš„ä¸€äº›çœ‹æ³•ã€‚
å‰è¨€ å¹¾å€‹æœˆçš„å¯¦é©—å’Œç ”ç©¶å¾Œï¼Œæˆ‘å€‘è·‘äº†ä¸€äº› DB-dependent Go appï¼Œæˆ‘å€‘å¾—åˆ°ä¸€å€‹çµè«–å°±æ˜¯ sqlc å¯ä»¥èªªæ˜¯æœ€å¥½çš„æ‹¿ä¾†ä½¿ç”¨çš„ Postgres (å¯ä»¥èƒ½å…¶ä»– databases ä¹Ÿæ˜¯)ã€‚è€Œä¸”åœ¨ Go code ä¹Ÿå¾ˆå®¹æ˜“ä½¿ç”¨ï¼Œä»¥ä¸‹å°±è®“ä¾†ä»‹ç´¹ä¸€ä¸‹æˆ‘å€‘çš„ç ”ç©¶å§ï¼&mldr;</div><a class=readmore href=/posts/sqlc/>Read more âŸ¶</a></section><section class=list-item><h1 class=title><a href=/posts/notion/>&lt;Notion çš„ Data Model & Sharding Postgres></a></h1><time>Feb 14, 2023</time><br><div class=description>Index ç°¡ä»‹ Notion æ˜¯å•¥ï¼Ÿ Blocks Blocks çš„ Schema Blocks çš„ç‰¹è‰²ï¼š Dynamic Change Blocks æ€éº¼çµ„è£å’Œé‹ä½œèµ·ä¾†å‘¢ï¼Ÿ Render Tree Indentation Permissions Block çš„ç”Ÿå‘½é€±æœŸ Creating and updating Real-time updates Reading blocks Sharding Sharding è¦è€ƒæ…®çš„å•é¡Œ Sharding çš„è§£æ±ºç­–ç•¥ Sharding çš„å¯¦éš›è§£æ±ºæ–¹æ¡ˆ Migrating to shards Double-writing with an audit log Backfilling old data Verifying data integrity Difficult lessons learned æ—©é» Shard ä»¥ zero-downtime migration ç‚ºç›®æ¨™ ä½¿ç”¨ combined primary key è€Œä¸æ˜¯åˆ†é›¢çš„ partition keyï¼š å¿ƒå¾— ç°¡ä»‹ é€™ç¯‡æ–‡ç« æœƒçµ±æ•´ Notion å…©ç¯‡éå¸¸é‡è¦çš„å·¥ç¨‹éƒ¨è½æ ¼ï¼Œåˆ†åˆ¥æ˜¯ &lt;The data model behind Notion&rsquo;s flexibility> å’Œ &lt;Herding elephants: Lessons learned from sharding Postgres at Notion>ï¼Œå…¶ç°¡å–®æ‰¼è¦åœ°è¬›è¿°äº† Notion èƒŒå¾Œçš„å·¥ç¨‹è¨­è¨ˆï¼Œæˆ‘ä¸€å‘å–œæ­¡ç ”ç©¶è‡ªå·±è¦ºå¾—å¾ˆå¥½ç”¨çš„å·¥å…·æ€éº¼è¨­è¨ˆçš„ï¼Œå°±è®“æˆ‘å€‘ä¾†çœ‹çœ‹å§ã€‚&mldr;</div><a class=readmore href=/posts/notion/>Read more âŸ¶</a></section><ul class=pagination><span class="page-item page-prev"></span><span class="page-item page-next"><a href=/page/2/ class=page-link aria-label=Next><span aria-hidden=true>Next â†’</span></a></span></ul></main><footer><div style=display:flex><a class=soc href=https://github.com/tachunwu rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a></div><div class=footer-info>2023 ğŸ’  Â© Tachunn | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><script>feather.replace()</script></div></body></html>