<!doctype html><html><head><meta name=generator content="Hugo 0.111.3"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Tachunn Publication | Home</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta property="og:image" content><link rel=alternate type=application/rss+xml href=https://tachunwu.github.io/index.xml title="Tachunn Publication"><meta property="og:title" content="Tachunn Publication"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://tachunwu.github.io/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tachunn Publication"><meta name=twitter:description content><script src=https://tachunwu.github.io/js/feather.min.js></script>
<link href=https://tachunwu.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://tachunwu.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css></head><body><div class=content><header><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><div class=main><a href=https://tachunwu.github.io/>Tachunn Publication</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main class=list><div class=site-description></div><section class=list-item><h1 class=title><a href=/posts/notion/>&lt;Notion çš„ Data Model & Sharding Postgres></a></h1><time>Feb 14, 2023</time><br><div class=description>Index ç°¡ä»‹ Notion æ˜¯å•¥ï¼Ÿ Blocks Blocks çš„ Schema Blocks çš„ç‰¹è‰²ï¼š Dynamic Change Blocks æ€éº¼çµ„è£å’Œé‹ä½œèµ·ä¾†å‘¢ï¼Ÿ Render Tree Indentation Permissions Block çš„ç”Ÿå‘½é€±æœŸ Creating and updating Real-time updates Reading blocks Sharding Sharding è¦è€ƒæ…®çš„å•é¡Œ Sharding çš„è§£æ±ºç­–ç•¥ Sharding çš„å¯¦éš›è§£æ±ºæ–¹æ¡ˆ Migrating to shards Double-writing with an audit log Backfilling old data Verifying data integrity Difficult lessons learned æ—©é» Shard ä»¥ zero-downtime migration ç‚ºç›®æ¨™ ä½¿ç”¨ combined primary key è€Œä¸æ˜¯åˆ†é›¢çš„ partition keyï¼š å¿ƒå¾— ç°¡ä»‹ é€™ç¯‡æ–‡ç« æœƒçµ±æ•´ Notion å…©ç¯‡éå¸¸é‡è¦çš„å·¥ç¨‹éƒ¨è½æ ¼ï¼Œåˆ†åˆ¥æ˜¯ &lt;The data model behind Notion&rsquo;s flexibility> å’Œ &lt;Herding elephants: Lessons learned from sharding Postgres at Notion>ï¼Œå…¶ç°¡å–®æ‰¼è¦åœ°è¬›è¿°äº† Notion èƒŒå¾Œçš„å·¥ç¨‹è¨­è¨ˆï¼Œæˆ‘ä¸€å‘å–œæ­¡ç ”ç©¶è‡ªå·±è¦ºå¾—å¾ˆå¥½ç”¨çš„å·¥å…·æ€éº¼è¨­è¨ˆçš„ï¼Œå°±è®“æˆ‘å€‘ä¾†çœ‹çœ‹å§ã€‚&mldr;</div><a class=readmore href=/posts/notion/>Read more âŸ¶</a></section><section class=list-item><h1 class=title><a href=/posts/enako/>&lt;ãˆãªã“å¯«çœŸé›†ã€OFF COSTUMEã€></a></h1><time>Feb 14, 2023</time><br><div class=description>é€™æœ¬æ˜¯æˆ‘æ”¶è—ä¸€ç›´å¾ˆå–œæ­¡çš„ coser Enako çš„å¯«çœŸé›†ï¼Œé¸äº†ä¸€é»é»å…§å®¹ï¼Œç”¨ VSCO èª¿è‰²ä¸€ä¸‹ä¾†åˆ†äº«ä¸€ä¸‹æˆ‘çš„æ„Ÿå‹• >///&lt;
å°é¢æ˜¯æ³¡æ¾¡çš„å¯æ„›ä¿çš®æ¨¡æ¨£ å¦‚æœæŠŠæ›¸çš®æ‹¿é–‹åŸç”Ÿå°é¢æ˜¯å¤•é™½ä¸‹çš„ Enakoï¼Œå¥½æ¸…æ¾ˆçš„çœ¼ç¥ è²¼è¿‘è‡ªç„¶çš„è‰çš®è‰²èª¿ï¼Œè®“ç•«é¢è¦–è¦ºå¾ˆè¦ªè¿‘äººçš„æ„Ÿè¦º åƒæ˜¯ä¸€èµ·èµ·åºŠäº’çœ‹çš„ç¬¬ä¸€çœ¼ï¼Œæœ‰é»æ”¾ç©ºæ…µæ‡¶çš„å¹¸ç¦ å–æ°´çš„æ¨£å­å’Œè‚Œè†šçš„é€æ˜æ„Ÿï¼ŒçœŸçš„æ˜¯å¾ˆç¾çš„ç•«é¢ æœ‰é»æˆäººçš„è¦–è§’ï¼Œä¸éåªæ˜¯å‰èœ å®Œç¾çš„æ›²ç·šï¼Œç¾çš„è®“äººæ­¢æ¯ é€£å¼µçš„éƒ¨åˆ†é–‹å§‹æœ‰é»æŒ‘é€—çš„æ„å‘³ å‡ºéŠé’æ˜¥çš„çš„æ¨£å­ï¼Œåƒæ˜¯å¤¢å¹»çš„æ™‚å…‰ å¾©å¤çš„åº•ç‰‡ç›¸æ©Ÿå’Œå¥¹çš„ç³å­”å‘ˆç¾å›æ†¶çš„é‡è¦ èª¿çš®çš„æˆ²æ°´ç¬é–“ï¼Œå½·å½¿å¹¸ç¦æ°¸æ†åœç•™åœ¨é‚£å‰é‚£ æœ‰é»å°è‰²æ¬²ï¼Œä½†æ˜¯åˆæ˜¯å¦‚æ­¤çš„æ—¥å¸¸ é¡é¢çš„æ§‹åœ–ï¼Œå‘ˆç¾ç²¾ç·»çš„äº”å®˜ å¾®æ¿•åŠéœ²çš„è¦–è§’ï¼Œåƒæ˜¯è—è¡“å“ä¸€æ¨£çš„å­˜åœ¨ &mldr;</div><a class=readmore href=/posts/enako/>Read more âŸ¶</a></section><section class=list-item><h1 class=title><a href=/posts/olep/>&lt;OLEPï¼šOnline Event Processing ç³»çµ±è¨­è¨ˆ></a></h1><time>Feb 10, 2023</time><br><div class=description>Index å°è¨€ å‰è¨€ Applcation Architecture Todayï¼šå¤šç•°è³ªæ€§å„²å­˜ Full-text search Data warehousing Stream processing Application-level caching Example: Heterogeneous storage Distributed Transactions Homogeneous distributed transactions Heterogeneous distributed transactions Event Logs Log çš„ç‰¹æ€§ Subscribers ä½¿ç”¨ Log æ™‚çš„é‡é» Exampleï¼šFinancial Payments System Stage-1. è½‰å¸³è«‹æ±‚ Stage-2. Single-threaded è™•ç† Stage-3. æ±ºç­– & è™•ç† Stage-4. ç³»çµ±å›é¥‹ Stage-5. æ¥å—ç«¯ Stage-6. å›å ±çµæœ Some notes: Scale OLEP çš„å„ªé» Log ç¨ç«‹æ€§å’Œæ“´å……æ€§ å¯å†ç¶­è­·æ€§ & Debug Data Modeling Data Analysis Distributed Transaction OLEP çš„ç¼ºé» Latency ä¸€è‡´æ€§å•é¡Œ å¿ƒå¾— å°è¨€ ä»Šå¤©åˆ†äº«çš„é€™ç¯‡è«–æ–‡ &lt;Online Event Processing: Achieving consistency where distributed transactions have failed> æ˜¯ç”±é¼é¼å¤§åçš„ Martin Kleppmann æ‰€æ’°å¯«ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶ç†ŸçŸ¥ DDIA çš„ä½œè€… (ä¸‹åœ–)ï¼Œæ­¤æ›¸è¢«è­½ç‚ºåŒ—ç¾è»Ÿé«”å·¥ç¨‹å¸«å¿…çœ‹çš„ä¸€æœ¬æ›¸ã€‚&mldr;</div><a class=readmore href=/posts/olep/>Read more âŸ¶</a></section><ul class=pagination><span class="page-item page-prev"><a href=/ class=page-link aria-label=Previous><span aria-hidden=true>â† Prev</span></a></span>
<span class="page-item page-next"><a href=/page/3/ class=page-link aria-label=Next><span aria-hidden=true>Next â†’</span></a></span></ul></main><footer><div style=display:flex><a class=soc href=https://github.com/tachunwu rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a></div><div class=footer-info>2023 ğŸ’  Â© Tachunn | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><script>feather.replace()</script></div></body></html>