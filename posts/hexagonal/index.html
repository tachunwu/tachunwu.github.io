<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>&lt;Netflix çš„è»Ÿé«”è¨­è¨ˆå“²å­¸ï¼šHexagonal Archtecture> - Tachunn Publication</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Index å°è¨€ å‰è¨€ Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ Chapter 2ï¼šMonolith to Microservices Chapter 3ï¼šHexagonal Architecture Core concepts Data Sources Transport Layer The dependency graph Chapter 4ï¼šSwapping data sourcesï¼ Production å¯¦éš›æƒ…æ³ éš±è— data source çš„ç´°ç¯€ Chapter 5ï¼šTesting strategy Interactors test Data sources test E2E test å¿ƒå¾—èˆ‡ç¸½çµ å°è¨€ é€™ç¯‡æ˜¯æ•´ç†ç¿»è­¯ <Ready for changes with Hexagonal Architecture>ï¼Œå…¶ä¸­ Netflix å·¥ç¨‹å¸«æŠŠå®ƒå€‘å¾ Monolith è½‰æ›åˆ° Microservices ç„¶å¾Œä»‹ç´¹ Hexagonal Architecture ç¨®ç¨®ç´°ç¯€ã€‚
å»ºè­°å„ä½è®€è€…æŠŠé€™ç¯‡ç•¶æˆæ•…äº‹ï¼Œæ›´èƒ½äº†è§£ Microservices å’Œ Hexagonal Architecture èª•ç”Ÿçš„å› æœã€‚
å‰è¨€ éš¨è‘—æ¯å¹´çš„ Netflix æˆé•·ï¼Œæˆ‘å€‘å¯¦ä½œ Application çš„æ™‚å€™å¿…é ˆç¶­æŒå¾ˆé«˜çš„æ•ˆç‡ã€‚æˆ‘å€‘çš„ Engineering çµ„ç¹”å¾ç·¨åŠ‡ã€æ’­æ”¾ã€æ’ç¨‹ã€ä¾›æ‡‰å•†ç®¡ç†ã€ç²å–åŠ‡æœ¬å…§å®¹&mldr;etcï¼Œç®¡ç†è¶…å¤šçš„ Applications ã€‚"><meta property="og:image" content><meta property="og:title" content="<Netflix çš„è»Ÿé«”è¨­è¨ˆå“²å­¸ï¼šHexagonal Archtecture>"><meta property="og:description" content="Index å°è¨€ å‰è¨€ Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ Chapter 2ï¼šMonolith to Microservices Chapter 3ï¼šHexagonal Architecture Core concepts Data Sources Transport Layer The dependency graph Chapter 4ï¼šSwapping data sourcesï¼ Production å¯¦éš›æƒ…æ³ éš±è— data source çš„ç´°ç¯€ Chapter 5ï¼šTesting strategy Interactors test Data sources test E2E test å¿ƒå¾—èˆ‡ç¸½çµ å°è¨€ é€™ç¯‡æ˜¯æ•´ç†ç¿»è­¯ <Ready for changes with Hexagonal Architecture>ï¼Œå…¶ä¸­ Netflix å·¥ç¨‹å¸«æŠŠå®ƒå€‘å¾ Monolith è½‰æ›åˆ° Microservices ç„¶å¾Œä»‹ç´¹ Hexagonal Architecture ç¨®ç¨®ç´°ç¯€ã€‚
å»ºè­°å„ä½è®€è€…æŠŠé€™ç¯‡ç•¶æˆæ•…äº‹ï¼Œæ›´èƒ½äº†è§£ Microservices å’Œ Hexagonal Architecture èª•ç”Ÿçš„å› æœã€‚
å‰è¨€ éš¨è‘—æ¯å¹´çš„ Netflix æˆé•·ï¼Œæˆ‘å€‘å¯¦ä½œ Application çš„æ™‚å€™å¿…é ˆç¶­æŒå¾ˆé«˜çš„æ•ˆç‡ã€‚æˆ‘å€‘çš„ Engineering çµ„ç¹”å¾ç·¨åŠ‡ã€æ’­æ”¾ã€æ’ç¨‹ã€ä¾›æ‡‰å•†ç®¡ç†ã€ç²å–åŠ‡æœ¬å…§å®¹&mldr;etcï¼Œç®¡ç†è¶…å¤šçš„ Applications ã€‚"><meta property="og:type" content="article"><meta property="og:url" content="https://tachunwu.github.io/posts/hexagonal/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-23T16:47:26+08:00"><meta property="article:modified_time" content="2023-02-23T16:47:26+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="<Netflix çš„è»Ÿé«”è¨­è¨ˆå“²å­¸ï¼šHexagonal Archtecture>"><meta name=twitter:description content="Index å°è¨€ å‰è¨€ Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ Chapter 2ï¼šMonolith to Microservices Chapter 3ï¼šHexagonal Architecture Core concepts Data Sources Transport Layer The dependency graph Chapter 4ï¼šSwapping data sourcesï¼ Production å¯¦éš›æƒ…æ³ éš±è— data source çš„ç´°ç¯€ Chapter 5ï¼šTesting strategy Interactors test Data sources test E2E test å¿ƒå¾—èˆ‡ç¸½çµ å°è¨€ é€™ç¯‡æ˜¯æ•´ç†ç¿»è­¯ <Ready for changes with Hexagonal Architecture>ï¼Œå…¶ä¸­ Netflix å·¥ç¨‹å¸«æŠŠå®ƒå€‘å¾ Monolith è½‰æ›åˆ° Microservices ç„¶å¾Œä»‹ç´¹ Hexagonal Architecture ç¨®ç¨®ç´°ç¯€ã€‚
å»ºè­°å„ä½è®€è€…æŠŠé€™ç¯‡ç•¶æˆæ•…äº‹ï¼Œæ›´èƒ½äº†è§£ Microservices å’Œ Hexagonal Architecture èª•ç”Ÿçš„å› æœã€‚
å‰è¨€ éš¨è‘—æ¯å¹´çš„ Netflix æˆé•·ï¼Œæˆ‘å€‘å¯¦ä½œ Application çš„æ™‚å€™å¿…é ˆç¶­æŒå¾ˆé«˜çš„æ•ˆç‡ã€‚æˆ‘å€‘çš„ Engineering çµ„ç¹”å¾ç·¨åŠ‡ã€æ’­æ”¾ã€æ’ç¨‹ã€ä¾›æ‡‰å•†ç®¡ç†ã€ç²å–åŠ‡æœ¬å…§å®¹&mldr;etcï¼Œç®¡ç†è¶…å¤šçš„ Applications ã€‚"><script src=https://tachunwu.github.io/js/feather.min.js></script>
<link href=https://tachunwu.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://tachunwu.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css></head><body><div class=content><header><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><div class=main><a href=https://tachunwu.github.io/>Tachunn Publication</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>&lt;Netflix çš„è»Ÿé«”è¨­è¨ˆå“²å­¸ï¼šHexagonal Archtecture></h1><div class=meta>Posted on Feb 23, 2023</div></div><section class=body><p><img src=/images/hexagonal_head.png alt><div><h2>Index</h2><nav id=TableOfContents><ol><li><a href=#å°è¨€><a href>å°è¨€</a></a></li><li><a href=#å‰è¨€><a href>å‰è¨€</a></a></li><li><a href=#chapter-1é«˜åº¦çš„æ•´åˆ><a href>Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ</a></a></li><li><a href=#chapter-2monolith-to-microservices><a href>Chapter 2ï¼šMonolith to Microservices</a></a></li><li><a href=#chapter-3hexagonal-architecture><a href>Chapter 3ï¼š<strong><strong>Hexagonal Architecture</strong></strong></a></a><ol><li><a href=#core-concepts><a href>Core <strong><strong>concepts</strong></strong></a></a></li><li><a href=#data-sources><a href><strong>Data Sources</strong></a></a></li><li><a href=#transport-layer><a href><strong>Transport Layer</strong></a></a></li><li><a href=#the-dependency-graph><a href>The dependency graph</a></a></li></ol></li><li><a href=#chapter-4swapping-data-sources><a href>Chapter 4ï¼š<strong><strong>Swapping data sourcesï¼</strong></strong></a></a><ol><li><a href=#production-å¯¦éš›æƒ…æ³><a href>Production å¯¦éš›æƒ…æ³</a></a></li><li><a href=#éš±è—-data-source-çš„ç´°ç¯€><a href>éš±è— data source çš„ç´°ç¯€</a></a></li></ol></li><li><a href=#chapter-5testing-strategy><a href>Chapter 5ï¼š<strong><strong>Testing strategy</strong></strong></a></a><ol><li><a href=#interactors-test><a href>Interactors test</a></a></li><li><a href=#data-sources-test><a href><strong>Data sources test</strong></a></a></li><li><a href=#e2e-test><a href>E2E <strong>test</strong></a></a></li></ol></li><li><a href=#å¿ƒå¾—èˆ‡ç¸½çµ><a href>å¿ƒå¾—èˆ‡ç¸½çµ</a></a></li></ol></nav></div></p><h1 id=å°è¨€><a href>å°è¨€</a></h1><p>é€™ç¯‡æ˜¯æ•´ç†ç¿»è­¯ &lt;<strong><strong><a href=https://netflixtechblog.com/ready-for-changes-with-hexagonal-architecture-b315ec967749>Ready for changes with Hexagonal Architecture</a></strong></strong>>ï¼Œå…¶ä¸­ Netflix å·¥ç¨‹å¸«æŠŠå®ƒå€‘å¾ Monolith è½‰æ›åˆ° Microservices ç„¶å¾Œä»‹ç´¹ Hexagonal Architecture ç¨®ç¨®ç´°ç¯€ã€‚</p><p><strong>å»ºè­°å„ä½è®€è€…æŠŠé€™ç¯‡ç•¶æˆæ•…äº‹ï¼Œæ›´èƒ½äº†è§£ Microservices å’Œ Hexagonal Architecture èª•ç”Ÿçš„å› æœã€‚</strong></p><h1 id=å‰è¨€><a href>å‰è¨€</a></h1><p>éš¨è‘—æ¯å¹´çš„ Netflix æˆé•·ï¼Œæˆ‘å€‘å¯¦ä½œ Application çš„æ™‚å€™å¿…é ˆç¶­æŒå¾ˆé«˜çš„æ•ˆç‡ã€‚æˆ‘å€‘çš„ Engineering çµ„ç¹”å¾ç·¨åŠ‡ã€æ’­æ”¾ã€æ’ç¨‹ã€ä¾›æ‡‰å•†ç®¡ç†ã€ç²å–åŠ‡æœ¬å…§å®¹&mldr;etcï¼Œç®¡ç†è¶…å¤šçš„ Applications ã€‚</p><h1 id=chapter-1é«˜åº¦çš„æ•´åˆ><a href>Chapter 1ï¼šé«˜åº¦çš„æ•´åˆ</a></h1><p>å¤§ç´„ä¸€å¹´å‰å§ (é€™è£¡æŒ‡çš„æ˜¯ 2019å¹´)ï¼Œ<strong>æˆ‘å€‘è¦é–‹ç™¼ä¸€å€‹è¶…å¤§å‹çš„å°ˆæ¡ˆï¼Œéœ€è¦æ•´åˆå¤šå€‹ Domainï¼Œè€Œä¸”é‚„è¦ç®¡ç†è¶…å¤šçš„ä¸åŒç³»çµ±çš„ Databaseã€‚</strong></p><p>å…·å€‹ä¾‹å­ä¾†èªªå¥½äº†ï¼Œåƒæ˜¯ï¼š</p><ul><li><strong>movies</strong></li><li><strong>production dates</strong></li><li><strong>employees</strong></li><li><strong>shooting locations</strong></li><li><strong>etcâ€¦</strong></li></ul><p>å…¨éƒ¨åˆ†æ•£åœ¨ä¸åŒçš„ servicesï¼Œprotocols ä¹Ÿå¾ˆå¤šç¨®ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>gRPC</strong></li><li><strong>JSON API</strong></li><li><strong>GraphQL</strong></li><li><strong>etcâ€¦</strong></li></ul><h1 id=chapter-2monolith-to-microservices><a href>Chapter 2ï¼šMonolith to Microservices</a></h1><p>ç•¶ Netflix é‚„æ˜¯å°å…¬å¸çš„æ™‚å€™ï¼Œæˆ‘å€‘ç‚ºäº† Application çš„èƒ½è¦‹åº¦ï¼Œæˆ‘å€‘é¸æ“‡ Monolith æ¶æ§‹ã€‚<strong>Monolith å¯ä»¥è¶…ç´šå¿«é€Ÿçš„é–‹ç™¼æ–°åŠŸèƒ½ã€‚åœ¨æŸå€‹æ™‚é–“é»éå¾Œï¼Œæˆ‘å€‘æœ‰è¶…é 30 å€‹å“¡å·¥ç®¡ç†è¶…é 300 å€‹ database tableï¼</strong></p><p>éš¨è‘—æ™‚é–“çš„æ¨ç§»ï¼ŒApplication é–‹å§‹æ…¢æ…¢è®Šå¾—é«˜åº¦å°ˆæ¥­åŒ–ã€‚<strong>æˆ‘å€‘æ±ºå®šé–‹å§‹é–‹å§‹æ‹†è§£ Monolithï¼Œé€™å€‹æ±ºå®šä¸æ˜¯å› ç‚ºæ€§èƒ½å•é¡Œï¼Œè€Œæ˜¯æœ‰äº› Domain å¤ªå°ˆæ¥­åˆè¤‡é›œäº†ï¼Œä¸å¾—å·²åˆ†é›¢å‡ºä¾†ç¨è‡ªæœ‰è‡ªå·±çš„é–‹ç™¼æµç¨‹ã€‚</strong></p><p>éš¨è‘—é–‹å§‹æ‰“é€ æ–°çš„ Applicationï¼Œæˆ‘å€‘éœ€è¦ç”¨åˆ°è¨±å¤šèˆŠç³»çµ±çš„è³‡æ–™ï¼Œè€Œéº»ç…©çš„é»åœ¨æ–¼é€™äº›è³‡æ–™åˆ†æ•£åœ¨ä¸åŒçš„ database ä¸Šã€‚æˆ‘å€‘é–‹å§‹æ„è­˜åˆ°æŠŠ monolith æ‹†åˆ†å·²ç¶“ä¸å¯é¿å…çš„æœƒç™¼ç”Ÿäº†ï¼Œæ‰€ä»¥æˆ‘å€‘é–‹å§‹é€æ¼¸çš„å¾ Monolith è®€å–å‡ºä¾†æ”¾åˆ°æ–°çš„ databaseï¼Œä¸€æ—¦ microservices ä¸Šç·šï¼Œæˆ‘å€‘å°±æœƒåˆ‡æ›åˆ°é€™äº› data sourcesã€‚</p><h1 id=chapter-3hexagonal-architecture><a href>Chapter 3ï¼š<strong><strong>Hexagonal Architecture</strong></strong></a></h1><p>æˆ‘å€‘æ±ºå®šç”¨ Hexagonal Architecture ä¾†è§£æ±ºä¸Šé¢çš„é›£é¡Œã€‚</p><p><strong>Hexagonal Architecture çš„æƒ³æ³•æ˜¯å°‡ input å’Œ output æ”¾åœ¨è¨­è¨ˆçš„é‚Šç·£ï¼Œå¯ä»¥ä¸å½±éŸ¿å•†æ¥­é‚è¼¯çš„æƒ…æ³ä¸‹æ›´æ› data sourcesã€‚</strong></p><blockquote><p><strong>Hexagonal Architecture çš„å“²å­¸æ˜¯å•†æ¥­é‚è¼¯ä¸æ‡‰è©²ä¾è³´æ–¼ä»»ä½• RESTã€GraphQL APIï¼Œé‚„æœ‰ä¹Ÿä¸èƒ½ä¾è³´æ–¼ data å¾å“ªè£¡ä¾†ï¼Œç”šè‡³æ˜¯å¾ä¸€å€‹ CSV æª”è®€å–ï¼Œéƒ½ä¸èƒ½å½±éŸ¿åˆ°å•†æ¥­é‚è¼¯ã€‚</strong></p></blockquote><p>å…¶ä¸­ä¸€å€‹æœ€å¤§çš„å¥½è™•å°±æ˜¯<strong>æˆ‘å€‘èƒ½å¤ ç¨ç«‹æ¸¬è©¦æˆ‘å€‘è‡ªå·±çš„å•†æ¥­é‚è¼¯æœ‰æ²’æœ‰å•é¡Œã€‚</strong></p><p><a href><em>è¨»è¨˜</em></a>ï¼š<em>ä»¥ä¸‹æˆ‘æœƒç”¨æˆ‘çš„ç†è§£å¯«ä¸€äº› Go codeï¼Œè€Œé€™äº›ä¸¦ä¸æ˜¯åŸå§‹æ–‡ç« çš„å…§å®¹ï¼Œè«‹è®€è€…æ³¨æ„ï¼</em></p><h2 id=core-concepts><a href>Core <strong><strong>concepts</strong></strong></a></h2><p>ç‚ºäº†æ¸…æ¥šçš„ä»‹ç´¹ Hexagonal Architectureï¼Œæˆ‘å€‘è¦å®šç¾©ä¸€ä¸‹å•†æ¥­é‚è¼¯çš„ä¸‰å€‹åè©ï¼Œåˆ†åˆ¥æ˜¯ <a href><strong>Entities, Repositories, Interactors</strong></a>ã€‚</p><h3 id=entities><strong>Entities</strong></h3><p><strong>Entities ä»£è¡¨ domain objects</strong>ï¼Œä¾‹å¦‚ï¼šMovieã€Shooting Locationï¼Œ<strong>å®ƒå€‘è‡ªå·±å®Œå…¨ä¸çŸ¥é“è‡ªå·±æœƒè¢«å„²å­˜åœ¨å“ªè£¡ã€‚</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Movie</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>           <span style=color:#66d9ef>int</span>    <span style=color:#75715e>// é›»å½± ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Title</span>        <span style=color:#66d9ef>string</span> <span style=color:#75715e>// é›»å½±åç¨±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>ReleaseYear</span>  <span style=color:#66d9ef>int</span>    <span style=color:#75715e>// ä¸Šæ˜ å¹´ä»½
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Description</span>  <span style=color:#66d9ef>string</span> <span style=color:#75715e>// é›»å½±ç°¡ä»‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ShootingLocation</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>        <span style=color:#66d9ef>int</span>    <span style=color:#75715e>// æ‹æ”åœ°é» ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Name</span>      <span style=color:#66d9ef>string</span> <span style=color:#75715e>// æ‹æ”åœ°é»åç¨±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Address</span>   <span style=color:#66d9ef>string</span> <span style=color:#75715e>// æ‹æ”åœ°é»åœ°å€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>City</span>      <span style=color:#66d9ef>string</span> <span style=color:#75715e>// æ‹æ”åœ°é»æ‰€åœ¨åŸå¸‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>State</span>     <span style=color:#66d9ef>string</span> <span style=color:#75715e>// æ‹æ”åœ°é»æ‰€åœ¨å·/çœ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Country</span>   <span style=color:#66d9ef>string</span> <span style=color:#75715e>// æ‹æ”åœ°é»æ‰€åœ¨åœ‹å®¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h3 id=repositories><strong>Repositories</strong></h3><p><strong>Repositories æ˜¯ä¸€ç¨® Interfaceï¼Œç¢ºä¿ Entities çš„å»ºç«‹å’Œæ”¹è®Šã€‚Repositories æœƒæä¾›ä¸€å † methods å¯ä»¥è·Ÿ data sources æºé€šï¼Œæ¯”å¦‚èªªï¼šå›å‚³ä¸€å€‹ User æˆ–æ˜¯ä¸€å † Usersã€‚</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>User</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>        <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Name</span>      <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Email</span>     <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>CreatedAt</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>UpdatedAt</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>UserRepository</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å–å¾—ä½¿ç”¨è€… by ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>GetUserByID</span>(<span style=color:#a6e22e>id</span> <span style=color:#66d9ef>string</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>User</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å–å¾—æ‰€æœ‰ä½¿ç”¨è€…
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>GetAllUsers</span>() ([]<span style=color:#f92672>*</span><span style=color:#a6e22e>User</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ–°å¢ä½¿ç”¨è€…
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>CreateUser</span>(<span style=color:#a6e22e>user</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>User</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// æ›´æ–°ä½¿ç”¨è€…
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>UpdateUser</span>(<span style=color:#a6e22e>user</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>User</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// åˆªé™¤ä½¿ç”¨è€… by ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>DeleteUserByID</span>(<span style=color:#a6e22e>id</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=interactors><strong>Interactors</strong></h3><p><strong>Interactors æ˜¯ç”¨ä¾†å¯¦ä½œèˆ‡åŸ·è¡Œç‰¹å®šé ˜åŸŸçš„å‹•ä½œæˆ–æ¥­å‹™é‚è¼¯ã€‚é€™äº›é¡åˆ¥é€šå¸¸è¢«ç¨±ç‚º Service Objects æˆ– Use Case Objectsï¼Œå®ƒå€‘å¯ä»¥èˆ‡ Repositories å’Œ Entities ä¸€èµ·ä½¿ç”¨</strong>ï¼Œç”¨æ–¼è§£æ±ºç‰¹å®šçš„å•é¡Œæˆ–åŸ·è¡ŒæŸäº›ä»»å‹™ã€‚</p><p><strong>Interactors çš„ä¸»è¦è·è²¬æ˜¯å”èª¿å’ŒåŸ·è¡Œé ˜åŸŸç›¸é—œçš„ä»»å‹™</strong>ï¼Œä¾‹å¦‚ï¼šåœ¨é›»å½±è£½ä½œä¸Šå»ºç«‹æ–°çš„é …ç›®ï¼Œç®¡ç†é …ç›®å…§çš„è³‡æ–™ï¼Œä¸¦æª¢æŸ¥ä¸¦é©—è­‰é …ç›®ä¸­çš„è³‡æ–™ï¼Œå®ƒå€‘ä¹Ÿå¯ä»¥å¯¦ç¾è¤‡é›œçš„æ¥­å‹™é‚è¼¯ã€‚</p><p>æ›´ç´°ç¯€ä¾†èªªåƒæ˜¯åœ¨å»ºç«‹æ–°çš„é …ç›®æ™‚ï¼Œæª¢æŸ¥ä¸€å€‹é …ç›®æ˜¯å¦ç¬¦åˆç‰¹å®šçš„è¦æ±‚ï¼Œä¸¦ç¢ºä¿å…¶éµå¾ªä¸€äº›æ¨™æº–ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Production</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>             <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Title</span>          <span style=color:#66d9ef>string</span>       <span style=color:#75715e>// ç‰‡å
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>ReleaseYear</span>    <span style=color:#66d9ef>int</span>          <span style=color:#75715e>// ç™¼è¡Œå¹´ä»½
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Description</span>    <span style=color:#66d9ef>string</span>       <span style=color:#75715e>// ç°¡ä»‹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>ProductionDate</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>    <span style=color:#75715e>// æ‹æ”æ—¥æœŸ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>ShootingLocation</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ShootingLocation</span>  <span style=color:#75715e>// æ‹æ”åœ°é»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Employees</span>      []<span style=color:#a6e22e>Employee</span>   <span style=color:#75715e>// åƒèˆ‡äººå“¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Employee</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>        <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FirstName</span> <span style=color:#66d9ef>string</span>          <span style=color:#75715e>// åå­—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>LastName</span>  <span style=color:#66d9ef>string</span>          <span style=color:#75715e>// å§“æ°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ShootingLocation</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>      <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Name</span>    <span style=color:#66d9ef>string</span>           <span style=color:#75715e>// åç¨±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Address</span> <span style=color:#66d9ef>string</span>           <span style=color:#75715e>// åœ°å€
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ProductionRepository</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Save</span>(<span style=color:#f92672>*</span><span style=color:#a6e22e>Production</span>) <span style=color:#66d9ef>error</span>   <span style=color:#75715e>// å„²å­˜ä¸€éƒ¨é›»å½±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ShootingLocationRepository</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>FindByID</span>(<span style=color:#66d9ef>int</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>ShootingLocation</span>, <span style=color:#66d9ef>error</span>)   <span style=color:#75715e>// ä¾æ“š ID å–å¾—æ‹æ”åœ°é»
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ProductionOnboardingInteractor</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>productionRepository</span>      <span style=color:#a6e22e>ProductionRepository</span>           <span style=color:#75715e>// é›»å½± Repository
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>shootingLocationRepository</span> <span style=color:#a6e22e>ShootingLocationRepository</span>     <span style=color:#75715e>// æ‹æ”åœ°é» Repository
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewProductionOnboardingInteractor</span>(<span style=color:#a6e22e>pr</span> <span style=color:#a6e22e>ProductionRepository</span>, <span style=color:#a6e22e>slr</span> <span style=color:#a6e22e>ShootingLocationRepository</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>ProductionOnboardingInteractor</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>ProductionOnboardingInteractor</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>productionRepository</span>: <span style=color:#a6e22e>pr</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>shootingLocationRepository</span>: <span style=color:#a6e22e>slr</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ProductionOnboardingInteractor</span>) <span style=color:#a6e22e>OnboardProduction</span>(<span style=color:#a6e22e>title</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>releaseYear</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>description</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>productionDate</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>, <span style=color:#a6e22e>shootingLocationID</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>employees</span> []<span style=color:#a6e22e>Employee</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>Production</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>shootingLocation</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>shootingLocationRepository</span>.<span style=color:#a6e22e>FindByID</span>(<span style=color:#a6e22e>shootingLocationID</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>empIDs</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>int</span>, len(<span style=color:#a6e22e>employees</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>e</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>employees</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>empIDs</span>[<span style=color:#a6e22e>i</span>] = <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>production</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Production</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Title</span>: <span style=color:#a6e22e>title</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ReleaseYear</span>: <span style=color:#a6e22e>releaseYear</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Description</span>: <span style=color:#a6e22e>description</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ProductionDate</span>: <span style=color:#a6e22e>productionDate</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ShootingLocation</span>: <span style=color:#a6e22e>shootingLocation</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Employees</span>: <span style=color:#a6e22e>employees</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>productionRepository</span>.<span style=color:#a6e22e>Save</span>(<span style=color:#a6e22e>production</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>production</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>æœ‰äº†å‰ä¸‰å€‹ä¸»è¦è§€å¿µï¼Œæˆ‘å€‘å¯ä»¥ä¸ç”¨ç†æœƒ Data Sources å’Œ Transport Layer ç­‰ç´°ç¯€ï¼Œå°±å¯ä»¥é©—è­‰å•†æ¥­é‚è¼¯çš„æ­£ç¢ºæ€§ã€‚</strong></p><h2 id=data-sources><a href><strong>Data Sources</strong></a></h2><p><strong>Data Source å¯¦ä½œäº†å­˜å– Repository æ‰€å®šç¾©çš„æ–¹æ³•ï¼Œä¸¦ä¸”å­˜å„²å’Œå‚³éè³‡æ–™çš„å¯¦ç¾æ–¹å¼ã€‚</strong></p><p>åœ¨ Hexagonal Architecture ä¸­ï¼Œ<strong>Data Sources ä½æ–¼æ‡‰ç”¨ç¨‹å¼æ ¸å¿ƒé‚Šç·£ï¼Œæ˜¯èˆ‡å¤–éƒ¨ç³»çµ±äº¤äº’çš„æ¥å£ã€‚ä½¿ç”¨ Data Sources çš„å¥½è™•æ˜¯ï¼Œç•¶éœ€è¦æ›´æ”¹å„²å­˜å¯¦ä½œæ™‚ï¼Œæ ¸å¿ƒæ¥­å‹™é‚è¼¯ä¸æœƒå—åˆ°å½±éŸ¿ã€‚</strong></p><p>Data Sources å¯ä»¥æ˜¯ä»¥ä¸‹ä¾‹å­ï¼š</p><ul><li><strong>SQL database adapter</strong></li><li><strong>elastic search adapter</strong></li><li><strong>REST API</strong></li><li><strong>CSV file</strong></li></ul><h2 id=transport-layer><a href><strong>Transport Layer</strong></a></h2><p><strong>Transport Layer æ˜¯ç”¨ä¾†è§¸ç™¼ Interactors é€²è¡Œæ¥­å‹™é‚è¼¯è™•ç†çš„è¼¸å…¥ä»‹é¢ã€‚æœ€å¸¸è¦‹ microservices çš„ Transport Layer æ˜¯HTTP API Layer å’Œè™•ç†è«‹æ±‚çš„ controller</strong>ã€‚é€šéå°‡æ¥­å‹™é‚è¼¯æŠ½è±¡åˆ° Interactor ä¸­ã€‚</p><p><strong>æˆ‘å€‘ä¸æœƒè¢«é™å®šæ–¼ç‰¹å®šçš„ Transport Layer æˆ– controllerã€‚Interactorå¯ä»¥è¢«å„ç¨®æ–¹å¼è§¸ç™¼ï¼Œä¸åƒ…å¯ä»¥ç”± controller è§¸ç™¼ï¼Œé‚„å¯ä»¥ç”± eventsã€cron jobã€command line è§¸ç™¼ã€‚</strong></p><h2 id=the-dependency-graph><a href>The dependency graph</a></h2><p>ä»¥ä¸‹å°±æ˜¯å®¹æ˜“ç†è§£çš„ dependency graphã€‚</p><p><img src=/images/hexagonal_0.png alt></p><p>å‚³çµ±çš„æ¶æ§‹éƒ½æ˜¯ä¸€è·¯å‘ä¸‹ä¾è³´ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>Transport layer ä¾è³´ Interactor Layer</strong></li><li><strong>Interactor Layer ä¾è³´ Persistence layer</strong></li></ul><p>ä½†åœ¨ Hexagonal Architectureï¼Œæ‰€æœ‰ä¾è³´éƒ½æŒ‡å‘ä¸­å¿ƒï¼Œåˆ†é›¢äº†å•†æ¥­é‚è¼¯å’Œå¤–éƒ¨çš„ Layerã€‚ä½†æ˜¯æˆ‘å€‘é‚„æ˜¯ä¿æœ‰ä»¥ä¸‹å„ªé»ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>Transport layer çŸ¥é“å¦‚ä½•ä½¿ç”¨ interactors</strong></li><li><strong>Repository interface ä¹Ÿèƒ½ä½¿ç”¨ data sources</strong></li></ul><p>åŸºæ–¼é€™äº›è¨­è¨ˆï¼Œè½‰æ› data sources å°±è®Šæˆå¾ˆå®¹æ˜“çš„ä»»å‹™ã€‚</p><h1 id=chapter-4swapping-data-sources><a href>Chapter 4ï¼š<strong><strong>Swapping data sourcesï¼</strong></strong></a></h1><h2 id=production-å¯¦éš›æƒ…æ³><a href>Production å¯¦éš›æƒ…æ³</a></h2><p>é›–ç„¶èªªæ¯”é æœŸçš„é‚„è¦æ—©åˆ‡æ› data sourcesï¼Œ<strong>æˆ‘å€‘æœ€çµ‚ç”¨ä¸Šé¢çš„æ¶æ§‹åœ¨ 2å°æ™‚å…§å®Œæˆäº†å¾ JSON API åˆ° GraphQLï¼Œè€Œä¸”åªä¿®æ”¹äº†ä¸€è¡Œ code å°±è¡Œï¼</strong></p><p>åœ¨éç¨‹ä¸­çªç„¶é‡åˆ°è®€å–é™åˆ¶çš„å•é¡Œï¼Œç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œéœ€è¦å°‡æŸå€‹ Entity çš„è®€å–è½‰æ›æˆä¸€å€‹æ–°çš„å¾®æœå‹™ã€‚<strong>é€™å€‹å¾®æœå‹™é€é GraphQL èšåˆå±¤æä¾›æœå‹™ã€‚é€™å€‹å¾®æœå‹™èˆ‡å–®é«”æ‡‰ç”¨ç¨‹å¼ä¿æŒåŒæ­¥ï¼Œä¸¦ä¸”æ“æœ‰ç›¸åŒçš„æ•¸æ“šï¼Œå¾å…¶ä¸­ä¸€å€‹æœå‹™è®€å–æˆ–å¾å¦ä¸€å€‹æœå‹™è®€å–ç”¢ç”Ÿç›¸åŒçš„çµæœã€‚</strong></p><p><img src=/images/hexagonal_1.png alt></p><h2 id=éš±è—-data-source-çš„ç´°ç¯€><a href>éš±è— data source çš„ç´°ç¯€</a></h2><p>å…¶ä¸­ä¸€å€‹å¥½è™•å°±æ˜¯å°±æ˜¯èƒ½å¤ å°è£ data source å¯¦ä½œçš„ç´°ç¯€ã€‚</p><p>æˆ‘å€‘æœ‰ä¸€å€‹ case æ˜¯æˆ‘å€‘éœ€è¦å‘¼å«ä¸‹æ¸¸çš„ APIï¼Œä¸éä¸‹æ¸¸çš„åœ˜éšŠæ²’æœ‰å¯¦ä½œ bulk fetchï¼Œåªæœ‰ single fetchï¼Œæ˜é¡¯éœ€è¦ä¸€äº›æ™‚é–“å¯¦ä½œã€‚</p><p>é‚£æ€éº¼éº¼è¾¦å‘¢ï¼Ÿ</p><p><strong>åœ˜éšŠæºé€šå¾Œæ±ºå®šç”¨ä¸€å€‹æ–¹æ³•ï¼Œæˆ‘å€‘åœ¨ repository ä¸­åŠ å…¥ä¸€å€‹ methodï¼Œæœƒ concurrent call ä¸‹æ¸¸çš„ single fetchï¼Œç„¶å¾ŒåŠ ä¸Š record idï¼Œé›–ç„¶åªæ˜¯æš«æ™‚çš„è§£æ±ºæ–¹æ¡ˆï¼Œä½†æ˜¯æˆ‘å€‘åªéœ€è¦ä¿®æ”¹ä¸€é»é»çš„ codeï¼Œå°±å¯ä»¥é”åˆ°æˆ‘å€‘è¦çš„æ•ˆæœã€‚</strong></p><p><img src=/images/hexagonal_2.png alt></p><p><strong>é€™å€‹æ¶æ§‹å¯ä»¥å¹«æˆ‘å€‘æ›´å¿«çš„äº¤ä»˜ç”¢å“ï¼Œè€Œä¸”æ›´å®¹æ˜“åœ°ç¶­è­·å’Œæ“´å±•ç³»çµ±ï¼ŒåŒæ™‚é™ä½äº†é¢¨éšªå’Œæˆæœ¬ã€‚</strong></p><h1 id=chapter-5testing-strategy><a href>Chapter 5ï¼š<strong><strong>Testing strategy</strong></strong></a></h1><p>ç•¶ç„¶å•¦~é¸æ“‡ Hexagonal Architecture æˆ‘å€‘å°±æƒ³å¥½äº†æ¸¬è©¦çš„ç­–ç•¥ï¼Œä»¥ä¸‹å°±ä»‹ç´¹ä¸€ä¸‹ã€‚</p><h2 id=interactors-test><a href>Interactors test</a></h2><p>Interactors testï¼Œæ¸¬è©¦æœ€æ ¸å¿ƒçš„åŠŸèƒ½ï¼Œé€™è£¡æ˜¯æˆ‘å€‘çš„å•†æ¥­é‚è¼¯ï¼Œæˆ‘å€‘æœƒæ­é… mock type repositoryã€‚<strong>ç”±æ–¼æ˜¯æ ¸å¿ƒå•†æ¥­é‚è¼¯ï¼Œæˆ‘å€‘æœƒæ¸¬åˆ°éå¸¸éå¸¸ç´°ç¯€</strong>ã€‚</p><p><img src=/images/hexagonal_3.png alt></p><h2 id=data-sources-test><a href><strong>Data sources test</strong></a></h2><p><strong>æ¥è‘—å°±æ˜¯æ¸¬è©¦ repository interface æœ‰æ²’æœ‰æ¥åˆ° data sourcesï¼Œç¢ºä¿æ±è¥¿çœŸçš„æœ‰å¯«é€²å»ã€‚</strong></p><p><img src=/images/hexagonal_4.png alt></p><h2 id=e2e-test><a href>E2E <strong>test</strong></a></h2><p>æœ€å¾Œå°±æ˜¯å…¨é¢çš„æ¸¬è©¦ï¼Œåœ¨ Hexagonal Architecture ä¸­ï¼Œæˆ‘å€‘æœ‰ä¸€çµ„é›†æˆæ¸¬è©¦ (Integration specs)ã€‚é€™äº›æ¸¬è©¦æœƒå¾æˆ‘å€‘çš„ <strong>Transport / API layer é–‹å§‹ï¼Œé€šé interactorsã€repositoriesã€data sourcesï¼Œç›´åˆ°æœ€å¾Œæ‰“åˆ°ä¸‹æ¸¸æœå‹™ (downstream services)</strong>ã€‚</p><p><strong>å¦‚æœä¸€å€‹ data source æ˜¯å¤–éƒ¨çš„ APIï¼Œæˆ‘å€‘æœƒæ‰“é€™å€‹ API ä¸¦ä¸”è¨˜éŒ„ä¸‹å›å‚³çš„ responseï¼ˆä¸¦å°‡å®ƒå€‘å„²å­˜åœ¨ git ä¸­ï¼‰</strong>ï¼Œé€™æ¨£æˆ‘å€‘çš„æ¸¬è©¦å¥—ä»¶åœ¨ä¹‹å¾Œçš„æ¯ä¸€æ¬¡åŸ·è¡Œä¸Šéƒ½å¯ä»¥å¿«é€Ÿé‹ä½œã€‚å°æ–¼é€™å±¤ï¼Œ<strong>æˆ‘å€‘ä¸æœƒé€²è¡Œå…¨é¢çš„æ¸¬è©¦æ¶µè“‹ï¼Œé€šå¸¸æ¯å€‹ domain action åªæœ‰ä¸€å€‹æˆåŠŸæƒ…å¢ƒå’Œä¸€å€‹å¤±æ•—æƒ…å¢ƒã€‚</strong></p><p><img src=/images/hexagonal_5.png alt></p><h1 id=å¿ƒå¾—èˆ‡ç¸½çµ><a href>å¿ƒå¾—èˆ‡ç¸½çµ</a></h1><p>é€™ç¯‡æ–‡ç« æ‡‰è©²ç®—æ˜¯ SaaS å’Œé–‹ç™¼å¾®æœå‹™çš„å¿…è®€æ–‡ç« ï¼Œæ¦‚å¿µå…¶å¯¦å’Œ Clean Architecture è »åƒçš„ï¼Œä¸é Netflix æ›´é‰…ç´°é¡éºå‘Šè¨´æˆ‘å€‘ç´°ç¯€ï¼Œç®—æ˜¯ä½œç‚º Back-end SWE çš„å…¥é–€ç£šå§ï¼Œæ„Ÿè¬ä½œè€…çš„åˆ†äº«ï¼</p></section><div class=post-tags></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/tachunwu rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a></div><div class=footer-info>2023 ğŸ’  Â© Tachunn | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-2LYZQ778V0"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2LYZQ778V0")</script><script>feather.replace()</script></div></body></html>